#! /bin/sh

# Start picom (compton)
picom --experimental-backends --backend glx --blur-method dual_kawase --blur-strength 10 &

# border width
bw=0

# launch drop down terminal if it's not running already
#ddterm_cmd="st -n ddterm -e tmux new-session -A -s ddterm"
#if ! pgrep -U ${USER:-$(whoami)} -f "st -n ddterm" >/dev/null; then
    #bspc rule -a st-256color:ddterm state=floating sticky=on rectangle=1920x588+-$bw+-$bw
    #$ddterm_cmd &
    #sleep .1
    #DDTERMWID="$(bspc query --nodes --node newest.floating.sticky)"
    #export DDTERMWID
#fi

## launch sxhkd if it's not running already
#sxhkd_cmd="sxhkd -c $XDG_CONFIG_HOME/bspwm/sxhkdrc"
#if ! pgrep -x -f -U ${USER:-$(whoami)} "$sxhkd_cmd" >/dev/null; then
    #env SXHKD_SHELL=/bin/dash $sxhkd_cmd &
#fi


sxhkd &

bspc monitor -d 1 2 3 4 5 6 7 8 9 10

bspc config normal_border_color "#282828"
bspc config focused_border_color "#504945"

bspc config border_width        $bw
bspc config border_radius       20
bspc config window_gap          26

bspc config split_ratio          0.52
bspc config borderless_monocle   true
bspc config gapless_monocle      true

bspc rule -a Gimp desktop='^8' state=floating follow=on
#bspc rule -a Chromium desktop='^2'
bspc rule -a mplayer2 state=floating
bspc rule -a Kupfer.py focus=on
bspc rule -a Screenkey manage=off

# --------------------------------
# ------- Non-BSPWM related ------
# --------------------------------
# Set wallpaper
feh --bg-fill ~/myStaff/wallpaper/1.jpg
# Reload .Xresources
#xrdb -load ~/.Xresources
# Launch polybar
~/.config/polybar/launch.sh
# Launch system tray staff
fcitx
nm-applet
# Change from ugly 'X' cursor when hovering over background
#xsetroot -cursor_name left_ptr
# Make betterlockscreen generate and cache a background image for locking
#betterlockscreen -u ~/Wallpapers/gruvbox.png
#exec $HOME/.config/polybar/launch.sh
xmodmap ~/.Xmodmap
